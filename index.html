<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitJourney · 12-Month Transformation Tracker</title>
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        body { background: #f4f7fb; font-family: 'Inter', system-ui, sans-serif; }
        .photo-card { transition: transform 0.1s ease; position: relative; }
        .photo-card:hover { transform: scale(1.02); }
        .tab-active { background: white; border-color: #3b82f6; color: #1e40af; font-weight: 600; }
        .month-tab { transition: all 0.2s; cursor: pointer; }
        .month-tab.active { background: #3b82f6; color: white; }
        .month-tab:hover:not(.active) { background: #e5e7eb; }
        .strength-badge {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .strength-positive { color: #4ade80; }
        .strength-negative { color: #f87171; }
        .idol-glow { box-shadow: 0 0 0 2px #fbbf24, 0 0 0 4px rgba(251, 191, 36, 0.2); }
        .user-glow { box-shadow: 0 0 0 2px #3b82f6, 0 0 0 4px rgba(59, 130, 246, 0.2); }
        .month-scroll { 
            overflow-x: auto; 
            scrollbar-width: thin;
            scrollbar-color: #3b82f6 #e5e7eb;
            padding-bottom: 8px;
        }
        .month-scroll::-webkit-scrollbar {
            height: 6px;
        }
        .month-scroll::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 10px;
        }
        .month-scroll::-webkit-scrollbar-thumb {
            background: #3b82f6;
            border-radius: 10px;
        }
        .routine-prefix-card {
            transition: all 0.2s;
        }
        .routine-prefix-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        }
        .easy-mode { border-left: 4px solid #10b981; }
        .medium-mode { border-left: 4px solid #f59e0b; }
        .hard-mode { border-left: 4px solid #ef4444; }
    </style>
</head>
<body class="p-4 md:p-6">

<div class="max-w-6xl mx-auto space-y-6">
    <!-- header -->
    <div class="flex items-center justify-between bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
        <div class="flex items-center gap-3">
            <i class="fas fa-dumbbell text-2xl text-blue-600"></i>
            <h1 class="text-2xl font-bold text-gray-800">FitJourney <span class="text-sm font-normal text-gray-400 ml-2">12-month transformation</span></h1>
        </div>
        <div class="text-sm text-gray-500"><i class="far fa-save mr-1"></i> auto-saved</div>
    </div>

    <!-- ========== PROFILE SECTION ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100" id="profileSection">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-gray-700 flex items-center gap-2"><i class="fas fa-user-circle text-blue-500"></i> My profile</h2>
            <button id="editProfileBtn" class="bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-full text-gray-700 transition text-sm flex items-center gap-1">
                <i class="fas fa-edit"></i> edit profile
            </button>
        </div>

        <!-- Profile View Mode -->
        <div id="profileView" class="flex flex-col sm:flex-row items-start sm:items-center gap-5">
            <div class="relative group">
                <div id="profilePicPreview" class="w-20 h-20 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-3xl font-bold shadow-sm overflow-hidden">
                    <img id="profileImage" src="" class="w-full h-full object-cover hidden">
                    <span id="profileInitials" class="block">AR</span>
                </div>
            </div>
            <div>
                <div class="flex items-center gap-2">
                    <span id="profileName" class="text-xl font-medium text-gray-800">Alex Rivera</span>
                    <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full">active</span>
                </div>
                <div class="text-sm text-gray-500 flex flex-col sm:flex-row sm:items-center gap-3 mt-1">
                    <span id="profileGoal"><i class="far fa-flag mr-1"></i> goal: build muscle & strength</span>
                    <span><i class="far fa-calendar mr-1"></i> joined Jan 2026</span>
                </div>
            </div>
        </div>

        <!-- Profile Edit Mode -->
        <div id="profileEdit" class="hidden">
            <div class="flex flex-col sm:flex-row gap-6">
                <div class="flex flex-col items-center">
                    <div class="relative w-24 h-24 rounded-full bg-gray-200 overflow-hidden group cursor-pointer" id="profilePicUploadArea">
                        <img id="editProfileImage" src="" class="w-full h-full object-cover hidden">
                        <div id="editProfileInitials" class="w-full h-full flex items-center justify-center text-2xl font-bold text-gray-600">AR</div>
                        <div class="absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
                            <i class="fas fa-camera text-white text-xl"></i>
                        </div>
                        <input type="file" id="profilePicInput" accept="image/*" class="hidden">
                    </div>
                    <p class="text-xs text-gray-400 mt-1">click to change</p>
                </div>

                <div class="flex-1 space-y-3">
                    <div>
                        <label class="text-xs text-gray-500 block">Display name</label>
                        <input type="text" id="editName" value="Alex Rivera" class="w-full border border-gray-300 rounded-lg p-2 text-sm">
                    </div>
                    <div>
                        <label class="text-xs text-gray-500 block">Fitness goal</label>
                        <input type="text" id="editGoal" value="build muscle & strength" class="w-full border border-gray-300 rounded-lg p-2 text-sm">
                    </div>
                    <div class="flex gap-2 pt-2">
                        <button id="saveProfileBtn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-full">save changes</button>
                        <button id="cancelProfileEditBtn" class="bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm px-4 py-2 rounded-full">cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== PREFIX ROUTINES SECTION (NEW) ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-gray-700 flex items-center gap-2"><i class="fas fa-layer-group text-purple-500"></i> My routine library</h2>
            <button id="addPrefixRoutineBtn" class="bg-purple-600 hover:bg-purple-700 text-white text-sm px-4 py-2 rounded-full transition flex items-center gap-1">
                <i class="fas fa-plus-circle"></i> create new routine
            </button>
        </div>

        <!-- Prefix Routines Grid -->
        <div id="prefixRoutinesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-4"></div>

        <!-- Quick add examples -->
        <div class="flex flex-wrap gap-2 mt-2">
            <button class="quick-add-routine bg-green-50 hover:bg-green-100 text-green-700 text-sm px-3 py-1.5 rounded-full transition flex items-center gap-1" data-mode="easy">
                <i class="fas fa-leaf"></i> Easy mode (pushup 10x5)
            </button>
            <button class="quick-add-routine bg-yellow-50 hover:bg-yellow-100 text-yellow-700 text-sm px-3 py-1.5 rounded-full transition flex items-center gap-1" data-mode="medium">
                <i class="fas fa-bolt"></i> Medium mode (pushup 15x4, squat 20x4)
            </button>
            <button class="quick-add-routine bg-red-50 hover:bg-red-100 text-red-700 text-sm px-3 py-1.5 rounded-full transition flex items-center gap-1" data-mode="hard">
                <i class="fas fa-fire"></i> Hard mode (pushup 20x5, pullup 8x4)
            </button>
        </div>
    </div>

    <!-- ========== IDOL BODY COMPARISON ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
        <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2"><i class="fas fa-star text-yellow-500"></i> Idol body comparison</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Left side: Idol photo and measurements -->
            <div class="space-y-4">
                <div class="flex items-center justify-between">
                    <h3 class="font-medium text-gray-700 flex items-center gap-2"><i class="fas fa-crown text-yellow-500"></i> Your Idol</h3>
                    <button id="uploadIdolBtn" class="bg-yellow-50 hover:bg-yellow-100 text-yellow-600 text-sm px-3 py-1.5 rounded-full transition flex items-center gap-1">
                        <i class="fas fa-cloud-upload-alt"></i> upload idol photo
                    </button>
                </div>
                
                <div id="idolImageContainer" class="relative bg-gray-100 rounded-xl h-48 flex items-center justify-center border-2 border-dashed border-yellow-300 overflow-hidden">
                    <img id="idolImage" src="" class="w-full h-full object-contain hidden">
                    <div id="idolPlaceholder" class="text-center text-gray-400">
                        <i class="fas fa-star text-3xl mb-2"></i>
                        <p class="text-sm">Upload your idol's photo</p>
                    </div>
                </div>
                
                <div id="idolMeasurements" class="bg-yellow-50 p-4 rounded-xl hidden">
                    <h4 class="text-sm font-semibold text-yellow-700 mb-3">Idol body measurements</h4>
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Shoulder width</span>
                                <span id="idolShoulder" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="idolShoulderBar" class="h-full bg-yellow-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Chest width</span>
                                <span id="idolChest" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="idolChestBar" class="h-full bg-yellow-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Waist width</span>
                                <span id="idolWaist" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="idolWaistBar" class="h-full bg-yellow-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Arm width</span>
                                <span id="idolArm" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="idolArmBar" class="h-full bg-yellow-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Estimated body fat</span>
                                <span id="idolBodyFat" class="font-mono">0%</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="idolBodyFatBar" class="h-full bg-yellow-500" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right side: Your photo and measurements -->
            <div class="space-y-4">
                <div class="flex items-center justify-between">
                    <h3 class="font-medium text-gray-700 flex items-center gap-2"><i class="fas fa-user text-blue-500"></i> Your body</h3>
                    <button id="uploadUserBodyBtn" class="bg-blue-50 hover:bg-blue-100 text-blue-600 text-sm px-3 py-1.5 rounded-full transition flex items-center gap-1">
                        <i class="fas fa-cloud-upload-alt"></i> upload your photo
                    </button>
                </div>
                
                <div id="userImageContainer" class="relative bg-gray-100 rounded-xl h-48 flex items-center justify-center border-2 border-dashed border-blue-300 overflow-hidden">
                    <img id="userImage" src="" class="w-full h-full object-contain hidden">
                    <div id="userPlaceholder" class="text-center text-gray-400">
                        <i class="fas fa-user text-3xl mb-2"></i>
                        <p class="text-sm">Upload your progress photo</p>
                    </div>
                </div>
                
                <div id="userMeasurements" class="bg-blue-50 p-4 rounded-xl hidden">
                    <h4 class="text-sm font-semibold text-blue-700 mb-3">Your measurements</h4>
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Shoulder width</span>
                                <span id="userShoulder" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="userShoulderBar" class="h-full bg-blue-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Chest width</span>
                                <span id="userChest" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="userChestBar" class="h-full bg-blue-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Waist width</span>
                                <span id="userWaist" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="userWaistBar" class="h-full bg-blue-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Arm width</span>
                                <span id="userArm" class="font-mono">0 cm</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="userArmBar" class="h-full bg-blue-500" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>Estimated body fat</span>
                                <span id="userBodyFat" class="font-mono">0%</span>
                            </div>
                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                <div id="userBodyFatBar" class="h-full bg-blue-500" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="comparisonResults" class="mt-6 bg-gradient-to-r from-yellow-50 to-blue-50 p-5 rounded-xl border border-gray-200 hidden">
            <h3 class="font-semibold text-gray-700 mb-4 flex items-center gap-2"><i class="fas fa-bullseye text-red-500"></i> Your journey to idol body</h3>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-xs text-gray-500">Shoulder gain needed</div>
                    <div class="text-xl font-bold text-gray-800" id="shoulderGap">0 cm</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-xs text-gray-500">Chest gain needed</div>
                    <div class="text-xl font-bold text-gray-800" id="chestGap">0 cm</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-xs text-gray-500">Waist to lose</div>
                    <div class="text-xl font-bold text-gray-800" id="waistGap">0 cm</div>
                </div>
                <div class="bg-white p-3 rounded-lg">
                    <div class="text-xs text-gray-500">Arm gain needed</div>
                    <div class="text-xl font-bold text-gray-800" id="armGap">0 cm</div>
                </div>
            </div>

            <div class="bg-indigo-50 p-4 rounded-lg">
                <div class="flex items-center justify-between flex-wrap gap-2">
                    <div>
                        <span class="text-sm text-indigo-700 font-medium">Estimated strength needed to achieve idol body:</span>
                        <div class="text-2xl font-bold text-indigo-600" id="strengthNeeded">0%</div>
                    </div>
                </div>
                <div class="mt-2 bg-white h-2 rounded-full overflow-hidden">
                    <div id="strengthNeededBar" class="h-full bg-indigo-500" style="width: 0%"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2" id="strengthMessage">Upload both photos to see your journey!</p>
            </div>
        </div>
    </div>

    <!-- ========== PROGRESS PHOTOS - 12 MONTHS ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-gray-700 flex items-center gap-2"><i class="fas fa-camera-retro text-blue-500"></i> Progress photos · 12 months</h2>
        </div>

        <!-- Month tabs - scrollable for 12 months -->
        <div class="month-scroll flex gap-1 mb-4 pb-2">
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-blue-600 text-white whitespace-nowrap" data-month="1">Month 1</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="2">Month 2</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="3">Month 3</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="4">Month 4</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="5">Month 5</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="6">Month 6</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="7">Month 7</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="8">Month 8</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="9">Month 9</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="10">Month 10</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="11">Month 11</button>
            <button class="month-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="12">Month 12</button>
        </div>

        <!-- upload area -->
        <div>
            <div class="flex flex-wrap items-center gap-3 mb-4">
                <label class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-full cursor-pointer inline-flex items-center gap-2 transition shadow-sm">
                    <i class="fas fa-cloud-upload-alt"></i> Upload photo to current month
                    <input type="file" id="photoInput" accept="image/*" class="hidden">
                </label>
                <span class="text-xs text-gray-400"><i class="fas fa-info-circle"></i> Each photo shows strength growth % from previous month</span>
            </div>

            <!-- photo grid -->
            <div id="photoGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 min-h-[120px] bg-gray-50 p-3 rounded-xl border border-dashed border-gray-200"></div>
            
            <!-- Monthly strength summary -->
            <div id="monthlyStrengthSummary" class="mt-4 grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2 hidden">
                <div class="bg-blue-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-blue-600">Month 1→2</div>
                    <div class="text-lg font-bold text-gray-800" id="month1to2">+0%</div>
                </div>
                <div class="bg-blue-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-blue-600">Month 2→3</div>
                    <div class="text-lg font-bold text-gray-800" id="month2to3">+0%</div>
                </div>
                <div class="bg-blue-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-blue-600">Month 3→4</div>
                    <div class="text-lg font-bold text-gray-800" id="month3to4">+0%</div>
                </div>
                <div class="bg-blue-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-blue-600">Month 4→5</div>
                    <div class="text-lg font-bold text-gray-800" id="month4to5">+0%</div>
                </div>
                <div class="bg-blue-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-blue-600">Month 5→6</div>
                    <div class="text-lg font-bold text-gray-800" id="month5to6">+0%</div>
                </div>
                <div class="bg-purple-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-purple-600">Month 6→7</div>
                    <div class="text-lg font-bold text-gray-800" id="month6to7">+0%</div>
                </div>
                <div class="bg-purple-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-purple-600">Month 7→8</div>
                    <div class="text-lg font-bold text-gray-800" id="month7to8">+0%</div>
                </div>
                <div class="bg-purple-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-purple-600">Month 8→9</div>
                    <div class="text-lg font-bold text-gray-800" id="month8to9">+0%</div>
                </div>
                <div class="bg-purple-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-purple-600">Month 9→10</div>
                    <div class="text-lg font-bold text-gray-800" id="month9to10">+0%</div>
                </div>
                <div class="bg-green-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-green-600">Month 10→11</div>
                    <div class="text-lg font-bold text-gray-800" id="month10to11">+0%</div>
                </div>
                <div class="bg-green-50 p-2 rounded-lg text-center">
                    <div class="text-xs text-green-600">Month 11→12</div>
                    <div class="text-lg font-bold text-gray-800" id="month11to12">+0%</div>
                </div>
                <div class="bg-green-600 p-2 rounded-lg text-center">
                    <div class="text-xs text-white">Overall</div>
                    <div class="text-lg font-bold text-white" id="month1to12">+0%</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== MONTHLY ROUTINE SELECTOR - 12 MONTHS ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
        <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2"><i class="fas fa-calendar-alt text-blue-500"></i> Monthly routines · 12 months</h2>
        
        <!-- Month selector tabs - scrollable -->
        <div class="month-scroll flex gap-1 mb-6 pb-2">
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-blue-600 text-white whitespace-nowrap" data-month="1">Month 1</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="2">Month 2</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="3">Month 3</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="4">Month 4</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="5">Month 5</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="6">Month 6</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="7">Month 7</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="8">Month 8</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="9">Month 9</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="10">Month 10</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="11">Month 11</button>
            <button class="month-tab routine-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300 whitespace-nowrap" data-month="12">Month 12</button>
        </div>

        <!-- Current month routines display -->
        <div id="monthlyRoutinesContainer" class="space-y-3"></div>

        <!-- Add routine to month button with dropdown from prefix routines -->
        <div class="mt-4 flex flex-wrap gap-2">
            <button id="addMonthlyRoutineBtn" class="bg-blue-50 hover:bg-blue-100 text-blue-600 text-sm px-4 py-2 rounded-full transition flex items-center gap-1">
                <i class="fas fa-plus-circle"></i> create new routine for month
            </button>
            <button id="usePrefixRoutineBtn" class="bg-purple-50 hover:bg-purple-100 text-purple-600 text-sm px-4 py-2 rounded-full transition flex items-center gap-1">
                <i class="fas fa-copy"></i> use routine from library
            </button>
        </div>
    </div>

    <!-- ========== WORKOUT ANALYTICS - 12 MONTHS ========== -->
    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
        <h2 class="text-lg font-semibold text-gray-700 mb-4 flex items-center gap-2"><i class="fas fa-chart-line text-blue-500"></i> 12-month analytics</h2>
        
        <!-- Frequency selector -->
        <div class="mb-6">
            <div class="flex items-center justify-between mb-2">
                <label class="text-sm text-gray-600">How many days per week do you train?</label>
                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full" id="frequencyMultiplierDisplay">Multiplier: 1.0x</span>
            </div>
            <div class="flex flex-wrap gap-2">
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="1">1 day/week (0.5x)</button>
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="2">2 days/week (1.0x)</button>
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="3">3 days/week (1.5x)</button>
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="4">4 days/week (2.0x)</button>
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="5">5 days/week (2.5x)</button>
                <button class="frequency-badge px-4 py-2 rounded-full border border-gray-300 text-sm hover:border-blue-500 transition" data-frequency="6">6 days/week (3.0x)</button>
            </div>
        </div>

        <!-- Monthly strength chart - 12 months -->
        <div class="mb-6">
            <h3 class="text-md font-medium text-gray-700 mb-3">12-month strength projection</h3>
            <div class="bg-gray-50 p-4 rounded-xl">
                <canvas id="strengthChart" style="width:100%; max-height:300px;"></canvas>
            </div>
        </div>

        <!-- Monthly performance summary -->
        <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2 mb-4">
            <div class="bg-blue-50 p-2 rounded-lg text-center">
                <div class="text-xs text-blue-600">Month 1</div>
                <div class="text-sm font-bold text-gray-800" id="month1Strength">0%</div>
            </div>
            <div class="bg-blue-50 p-2 rounded-lg text-center">
                <div class="text-xs text-blue-600">Month 2</div>
                <div class="text-sm font-bold text-gray-800" id="month2Strength">0%</div>
            </div>
            <div class="bg-blue-50 p-2 rounded-lg text-center">
                <div class="text-xs text-blue-600">Month 3</div>
                <div class="text-sm font-bold text-gray-800" id="month3Strength">0%</div>
            </div>
            <div class="bg-blue-50 p-2 rounded-lg text-center">
                <div class="text-xs text-blue-600">Month 4</div>
                <div class="text-sm font-bold text-gray-800" id="month4Strength">0%</div>
            </div>
            <div class="bg-blue-50 p-2 rounded-lg text-center">
                <div class="text-xs text-blue-600">Month 5</div>
                <div class="text-sm font-bold text-gray-800" id="month5Strength">0%</div>
            </div>
            <div class="bg-purple-50 p-2 rounded-lg text-center">
                <div class="text-xs text-purple-600">Month 6</div>
                <div class="text-sm font-bold text-gray-800" id="month6Strength">0%</div>
            </div>
            <div class="bg-purple-50 p-2 rounded-lg text-center">
                <div class="text-xs text-purple-600">Month 7</div>
                <div class="text-sm font-bold text-gray-800" id="month7Strength">0%</div>
            </div>
            <div class="bg-purple-50 p-2 rounded-lg text-center">
                <div class="text-xs text-purple-600">Month 8</div>
                <div class="text-sm font-bold text-gray-800" id="month8Strength">0%</div>
            </div>
            <div class="bg-purple-50 p-2 rounded-lg text-center">
                <div class="text-xs text-purple-600">Month 9</div>
                <div class="text-sm font-bold text-gray-800" id="month9Strength">0%</div>
            </div>
            <div class="bg-green-50 p-2 rounded-lg text-center">
                <div class="text-xs text-green-600">Month 10</div>
                <div class="text-sm font-bold text-gray-800" id="month10Strength">0%</div>
            </div>
            <div class="bg-green-50 p-2 rounded-lg text-center">
                <div class="text-xs text-green-600">Month 11</div>
                <div class="text-sm font-bold text-gray-800" id="month11Strength">0%</div>
            </div>
            <div class="bg-green-600 p-2 rounded-lg text-center">
                <div class="text-xs text-white">Month 12</div>
                <div class="text-sm font-bold text-white" id="month12Strength">0%</div>
            </div>
        </div>
    </div>

    <!-- footer -->
    <div class="text-xs text-center text-gray-400 pt-2">✓ 12-month tracking • Monthly progress photos • Routines • Analytics</div>
</div>

<!-- Modal for selecting prefix routine -->
<div id="selectRoutineModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4">
        <h3 class="text-lg font-semibold mb-4">Select a routine from your library</h3>
        <div id="routineSelectionList" class="space-y-2 max-h-96 overflow-y-auto mb-4"></div>
        <div class="flex justify-end">
            <button id="closeRoutineModal" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-full text-sm">Cancel</button>
        </div>
    </div>
</div>

<script>
    (function() {
        // STORAGE KEYS
        const STORAGE_PHOTOS = 'fitjourney_photos_12';
        const STORAGE_PHOTO_MEASUREMENTS = 'fitjourney_photo_measurements_12';
        const STORAGE_MONTHLY_ROUTINES = 'fitjourney_monthly_routines_12';
        const STORAGE_PREFIX_ROUTINES = 'fitjourney_prefix_routines_12'; // NEW
        const STORAGE_PROFILE = 'fitjourney_profile_12';
        const STORAGE_FREQUENCY = 'fitjourney_frequency_12';
        const STORAGE_IDOL_DATA = 'fitjourney_idol_data_12';
        const STORAGE_USER_BODY_DATA = 'fitjourney_user_body_data_12';

        // DEFAULT PROFILE
        const defaultProfile = {
            name: 'Alex Rivera',
            goal: 'build muscle & strength',
            profilePic: null
        };

        // Initialize empty data for 12 months
        let photos = {};
        let photoMeasurements = {};
        let monthlyRoutines = {};
        let prefixRoutines = []; // NEW: Array to store user's custom routines

        // Initialize all 12 months with empty arrays
        for (let i = 1; i <= 12; i++) {
            photos['month' + i] = [];
            photoMeasurements['month' + i] = [];
            monthlyRoutines['month' + i] = [];
        }

        // Load from localStorage or use defaults
        try {
            const savedPhotos = localStorage.getItem(STORAGE_PHOTOS);
            if (savedPhotos) photos = JSON.parse(savedPhotos);
            
            const savedMeasurements = localStorage.getItem(STORAGE_PHOTO_MEASUREMENTS);
            if (savedMeasurements) photoMeasurements = JSON.parse(savedMeasurements);
            
            const savedRoutines = localStorage.getItem(STORAGE_MONTHLY_ROUTINES);
            if (savedRoutines) monthlyRoutines = JSON.parse(savedRoutines);
            
            // NEW: Load prefix routines
            const savedPrefixRoutines = localStorage.getItem(STORAGE_PREFIX_ROUTINES);
            if (savedPrefixRoutines) {
                prefixRoutines = JSON.parse(savedPrefixRoutines);
            } else {
                // Add default routines
                prefixRoutines = [
                    {
                        id: 'prefix_easy_' + Date.now(),
                        name: 'Easy Mode',
                        exercises: [
                            { name: 'Push-ups', sets: 10, reps: 5 },
                            { name: 'Squats', sets: 10, reps: 5 }
                        ]
                    },
                    {
                        id: 'prefix_medium_' + (Date.now() + 1),
                        name: 'Medium Mode',
                        exercises: [
                            { name: 'Push-ups', sets: 15, reps: 4 },
                            { name: 'Squats', sets: 20, reps: 4 },
                            { name: 'Lunges', sets: 10, reps: 4 }
                        ]
                    },
                    {
                        id: 'prefix_hard_' + (Date.now() + 2),
                        name: 'Hard Mode',
                        exercises: [
                            { name: 'Push-ups', sets: 20, reps: 5 },
                            { name: 'Pull-ups', sets: 8, reps: 4 },
                            { name: 'Dips', sets: 12, reps: 4 },
                            { name: 'Burpees', sets: 10, reps: 3 }
                        ]
                    }
                ];
            }
        } catch (e) {
            console.log('Using default empty data');
        }

        let profile = JSON.parse(localStorage.getItem(STORAGE_PROFILE)) || defaultProfile;
        let workoutFrequency = parseInt(localStorage.getItem(STORAGE_FREQUENCY)) || 2;
        
        // Idol and user body data
        let idolData = JSON.parse(localStorage.getItem(STORAGE_IDOL_DATA)) || null;
        let userBodyData = JSON.parse(localStorage.getItem(STORAGE_USER_BODY_DATA)) || null;

        let currentPhotoMonth = 1;
        let currentRoutineMonth = 1;
        let strengthChart = null;

        // Save functions
        function savePhotos() { localStorage.setItem(STORAGE_PHOTOS, JSON.stringify(photos)); }
        function savePhotoMeasurements() { localStorage.setItem(STORAGE_PHOTO_MEASUREMENTS, JSON.stringify(photoMeasurements)); }
        function saveMonthlyRoutines() { localStorage.setItem(STORAGE_MONTHLY_ROUTINES, JSON.stringify(monthlyRoutines)); }
        function savePrefixRoutines() { localStorage.setItem(STORAGE_PREFIX_ROUTINES, JSON.stringify(prefixRoutines)); } // NEW
        function saveProfile() { localStorage.setItem(STORAGE_PROFILE, JSON.stringify(profile)); }
        function saveFrequency() { localStorage.setItem(STORAGE_FREQUENCY, workoutFrequency.toString()); }
        function saveIdolData(data) { 
            idolData = data;
            localStorage.setItem(STORAGE_IDOL_DATA, JSON.stringify(data)); 
        }
        function saveUserBodyData(data) { 
            userBodyData = data;
            localStorage.setItem(STORAGE_USER_BODY_DATA, JSON.stringify(data)); 
        }

        // ========== PREFIX ROUTINES FUNCTIONS (NEW) ==========
        function renderPrefixRoutines() {
            const grid = document.getElementById('prefixRoutinesGrid');
            
            if (prefixRoutines.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center text-gray-400 py-4"><i class="fas fa-dumbbell text-2xl mb-2"></i><p>No routines yet. Create your first routine!</p></div>';
                return;
            }

            grid.innerHTML = prefixRoutines.map(routine => {
                // Determine mode class based on name
                let modeClass = '';
                if (routine.name.toLowerCase().includes('easy')) modeClass = 'easy-mode';
                else if (routine.name.toLowerCase().includes('medium')) modeClass = 'medium-mode';
                else if (routine.name.toLowerCase().includes('hard')) modeClass = 'hard-mode';
                
                const exercisesList = routine.exercises.map(ex => 
                    `<div class="text-xs text-gray-600">${ex.name}: ${ex.sets} × ${ex.reps}</div>`
                ).join('');
                
                return `
                    <div class="bg-gray-50 rounded-xl p-3 border border-gray-200 routine-prefix-card ${modeClass}">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold text-gray-800">${routine.name}</h3>
                            <div class="flex gap-1">
                                <button class="text-blue-400 hover:text-blue-600 use-prefix-routine" data-id="${routine.id}" title="Add to current month">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <button class="text-red-400 hover:text-red-600 delete-prefix-routine" data-id="${routine.id}">
                                    <i class="far fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="space-y-1">${exercisesList}</div>
                    </div>
                `;
            }).join('');

            // Add event listeners for use and delete buttons
            document.querySelectorAll('.use-prefix-routine').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const routineId = btn.dataset.id;
                    const routine = prefixRoutines.find(r => r.id === routineId);
                    if (routine) {
                        addPrefixRoutineToMonth(routine);
                    }
                });
            });

            document.querySelectorAll('.delete-prefix-routine').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const routineId = btn.dataset.id;
                    if (confirm('Delete this routine from your library?')) {
                        prefixRoutines = prefixRoutines.filter(r => r.id !== routineId);
                        savePrefixRoutines();
                        renderPrefixRoutines();
                    }
                });
            });
        }

        function addPrefixRoutineToMonth(routine) {
            const monthKey = 'month' + currentRoutineMonth;
            
            // Create a copy of the routine for this month
            const newRoutine = {
                id: 'routine_' + Date.now(),
                name: routine.name + ' (from library)',
                exercises: routine.exercises.map(ex => ({ ...ex }))
            };
            
            if (!monthlyRoutines[monthKey]) monthlyRoutines[monthKey] = [];
            monthlyRoutines[monthKey].push(newRoutine);
            
            saveMonthlyRoutines();
            renderMonthlyRoutines();
            renderChart();
            
            // Show success message
            alert(`Added "${routine.name}" to Month ${currentRoutineMonth}`);
        }

        function showAddPrefixRoutineForm() {
            const formHtml = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" id="prefixRoutineModal">
                    <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4">
                        <h3 class="text-lg font-semibold mb-4">Create new routine</h3>
                        
                        <div class="mb-3">
                            <label class="text-xs text-gray-500 block mb-1">Routine name</label>
                            <input type="text" id="newPrefixRoutineName" placeholder="e.g., Easy Mode, Cardio Blast, etc." class="w-full border border-gray-300 rounded-lg p-2 text-sm">
                        </div>
                        
                        <div id="newPrefixExercisesList" class="space-y-2 mb-3 max-h-60 overflow-y-auto"></div>
                        
                        <div class="flex gap-2 mb-4">
                            <button id="addPrefixExerciseRowBtn" class="bg-gray-200 hover:bg-gray-300 text-sm px-3 py-1.5 rounded-full flex items-center gap-1">
                                <i class="fas fa-plus-circle"></i> add exercise
                            </button>
                        </div>
                        
                        <div class="flex gap-2 justify-end">
                            <button id="savePrefixRoutineBtn" class="bg-purple-600 hover:bg-purple-700 text-white text-sm px-4 py-2 rounded-full">save routine</button>
                            <button id="cancelPrefixRoutineBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm px-4 py-2 rounded-full">cancel</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', formHtml);
            
            function addExerciseRow() {
                const list = document.getElementById('newPrefixExercisesList');
                const row = document.createElement('div');
                row.className = 'flex gap-2 items-center bg-gray-50 p-2 rounded-lg';
                row.innerHTML = `
                    <input type="text" placeholder="Exercise" class="ex-name flex-1 text-sm border rounded p-1.5">
                    <input type="number" placeholder="Sets" class="ex-sets w-16 text-sm border rounded p-1.5">
                    <input type="number" placeholder="Reps" class="ex-reps w-16 text-sm border rounded p-1.5">
                    <button class="remove-ex-row text-red-400 hover:text-red-600">✕</button>
                `;
                row.querySelector('.remove-ex-row').addEventListener('click', () => row.remove());
                list.appendChild(row);
            }

            // Add initial 3 rows
            addExerciseRow();
            addExerciseRow();
            addExerciseRow();

            document.getElementById('addPrefixExerciseRowBtn').addEventListener('click', addExerciseRow);
            
            document.getElementById('cancelPrefixRoutineBtn').addEventListener('click', () => {
                document.getElementById('prefixRoutineModal').remove();
            });
            
            document.getElementById('savePrefixRoutineBtn').addEventListener('click', () => {
                const name = document.getElementById('newPrefixRoutineName').value.trim();
                if (!name) return alert('Please enter a routine name');
                
                const exerciseRows = document.querySelectorAll('#newPrefixExercisesList > div');
                const exercises = [];
                
                for (let row of exerciseRows) {
                    const exName = row.querySelector('.ex-name')?.value.trim();
                    const sets = row.querySelector('.ex-sets')?.value.trim();
                    const reps = row.querySelector('.ex-reps')?.value.trim();
                    
                    if (exName && sets && reps) {
                        exercises.push({ 
                            name: exName, 
                            sets: parseInt(sets), 
                            reps: parseInt(reps) 
                        });
                    }
                }
                
                if (exercises.length === 0) return alert('Add at least one exercise');
                
                const newRoutine = {
                    id: 'prefix_' + Date.now(),
                    name: name,
                    exercises: exercises
                };
                
                prefixRoutines.push(newRoutine);
                savePrefixRoutines();
                renderPrefixRoutines();
                
                document.getElementById('prefixRoutineModal').remove();
            });
        }

        // ========== BODY MEASUREMENT ESTIMATION ==========
        function estimateBodyMeasurements(imageDataUrl) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0, img.width, img.height);

                    // Simulate body detection with progressive improvement
                    const seed = (img.width * img.height) % 100;
                    
                    const shoulderWidth = Math.round(40 + (seed * 0.2));
                    const chestWidth = Math.round(shoulderWidth * 0.85);
                    const waistWidth = Math.round(chestWidth * 0.75);
                    const armWidth = Math.round(12 + (seed * 0.1));
                    const bodyFat = Math.round(12 + (seed * 0.15));

                    const measurements = {
                        shoulder: shoulderWidth,
                        chest: chestWidth,
                        waist: waistWidth,
                        arm: armWidth,
                        bodyFat: bodyFat,
                        timestamp: Date.now(),
                        strengthScore: Math.round(shoulderWidth + chestWidth + armWidth - waistWidth)
                    };

                    resolve(measurements);
                };
                img.src = imageDataUrl;
            });
        }

        // ========== PHOTO STRENGTH GROWTH CALCULATION ==========
        function calculateStrengthGrowth() {
            // Get the latest photo from each month
            const monthGains = {};
            let previousMonthScore = null;

            for (let month = 1; month <= 12; month++) {
                const monthKey = 'month' + month;
                const monthPhotos = photoMeasurements[monthKey] || [];
                const latestPhoto = monthPhotos.length > 0 ? monthPhotos[monthPhotos.length - 1] : null;
                
                if (latestPhoto) {
                    if (previousMonthScore !== null) {
                        const gain = Math.round(((latestPhoto.strengthScore - previousMonthScore) / previousMonthScore) * 100);
                        monthGains[`month${month-1}to${month}`] = gain;
                    }
                    previousMonthScore = latestPhoto.strengthScore;
                } else {
                    previousMonthScore = null;
                }
            }

            // Update UI with gains
            for (let i = 1; i < 12; i++) {
                const gainId = `month${i}to${i+1}`;
                const gain = monthGains[gainId] || 0;
                const element = document.getElementById(gainId);
                if (element) {
                    element.textContent = (gain >= 0 ? '+' : '') + gain + '%';
                    element.classList.toggle('text-green-600', gain > 0);
                    element.classList.toggle('text-red-600', gain < 0);
                }
            }

            // Calculate overall gain
            const month1Photos = photoMeasurements.month1 || [];
            const month12Photos = photoMeasurements.month12 || [];
            const month1Latest = month1Photos.length > 0 ? month1Photos[month1Photos.length - 1] : null;
            const month12Latest = month12Photos.length > 0 ? month12Photos[month12Photos.length - 1] : null;

            if (month1Latest && month12Latest) {
                const overallGain = Math.round(((month12Latest.strengthScore - month1Latest.strengthScore) / month1Latest.strengthScore) * 100);
                document.getElementById('month1to12').textContent = (overallGain >= 0 ? '+' : '') + overallGain + '%';
            }

            // Show summary if any photos exist
            let hasPhotos = false;
            for (let month = 1; month <= 12; month++) {
                if ((photoMeasurements['month' + month] || []).length > 0) {
                    hasPhotos = true;
                    break;
                }
            }
            document.getElementById('monthlyStrengthSummary').classList.toggle('hidden', !hasPhotos);

            return monthGains;
        }

        // ========== PROGRESS PHOTOS RENDERING ==========
        async function renderPhotos() {
            const grid = document.getElementById('photoGrid');
            let monthKey = 'month' + currentPhotoMonth;
            let monthPhotos = photos[monthKey] || [];
            let monthMeasurements = photoMeasurements[monthKey] || [];

            if (monthPhotos.length === 0) {
                grid.innerHTML = `<div class="col-span-full flex flex-col items-center justify-center py-6 text-gray-300"><i class="fas fa-image text-3xl mb-2"></i><span class="text-sm">No photos for month ${currentPhotoMonth} yet</span></div>`;
                return;
            }

            grid.innerHTML = '';
            
            // Sort by timestamp (newest first)
            const photoIndices = [...Array(monthPhotos.length).keys()].reverse();
            
            for (let index of photoIndices) {
                const photo = monthPhotos[index];
                const measurement = monthMeasurements[index] || { strengthScore: 0 };
                
                // Calculate growth from previous month (only for the latest photo)
                let growthText = '';
                let growthClass = '';
                
                if (currentPhotoMonth > 1 && index === monthPhotos.length - 1) {
                    const prevMonthKey = 'month' + (currentPhotoMonth - 1);
                    const prevMonthMeasurements = photoMeasurements[prevMonthKey] || [];
                    const prevMonthLatest = prevMonthMeasurements.length > 0 ? prevMonthMeasurements[prevMonthMeasurements.length - 1] : null;
                    
                    if (prevMonthLatest && measurement.strengthScore > 0) {
                        const growth = ((measurement.strengthScore - prevMonthLatest.strengthScore) / prevMonthLatest.strengthScore * 100).toFixed(1);
                        growthText = (growth >= 0 ? '+' : '') + growth + '%';
                        growthClass = growth >= 0 ? 'strength-positive' : 'strength-negative';
                    }
                }
                
                const card = document.createElement('div');
                card.className = 'relative photo-card group';
                card.innerHTML = `
                    <img src="${photo.dataURL}" class="w-full h-28 object-cover rounded-xl border border-gray-200 shadow-sm">
                    <button class="absolute top-1 right-1 bg-white hover:bg-red-50 rounded-full w-6 h-6 flex items-center justify-center text-red-500 opacity-0 group-hover:opacity-100 transition" data-delete-month="${currentPhotoMonth}" data-delete-index="${index}">
                        <i class="fas fa-times text-xs"></i>
                    </button>
                    ${growthText ? `<div class="strength-badge ${growthClass}">${growthText}</div>` : ''}
                    <span class="absolute bottom-1 left-1 bg-black bg-opacity-40 text-white text-[10px] px-1 rounded">M${currentPhotoMonth}</span>
                `;
                grid.appendChild(card);
            }

            // Delete handlers
            document.querySelectorAll('[data-delete-month]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const month = btn.dataset.deleteMonth;
                    const idx = btn.dataset.deleteIndex;
                    let monthKey = 'month' + month;
                    let photoMonthKey = 'month' + month;
                    
                    if (photos[photoMonthKey] && photos[photoMonthKey][idx]) {
                        photos[photoMonthKey].splice(idx, 1);
                        photoMeasurements[photoMonthKey].splice(idx, 1);
                        savePhotos();
                        savePhotoMeasurements();
                        renderPhotos();
                        calculateStrengthGrowth();
                    }
                });
            });

            calculateStrengthGrowth();
        }

        // ========== IDOL COMPARISON FUNCTIONS ==========
        function updateComparison() {
            if (!idolData || !userBodyData) return;

            document.getElementById('idolMeasurements').classList.remove('hidden');
            document.getElementById('userMeasurements').classList.remove('hidden');
            document.getElementById('comparisonResults').classList.remove('hidden');

            document.getElementById('idolShoulder').textContent = idolData.shoulder + ' cm';
            document.getElementById('idolChest').textContent = idolData.chest + ' cm';
            document.getElementById('idolWaist').textContent = idolData.waist + ' cm';
            document.getElementById('idolArm').textContent = idolData.arm + ' cm';
            document.getElementById('idolBodyFat').textContent = idolData.bodyFat + '%';

            document.getElementById('idolShoulderBar').style.width = (idolData.shoulder / 60 * 100) + '%';
            document.getElementById('idolChestBar').style.width = (idolData.chest / 60 * 100) + '%';
            document.getElementById('idolWaistBar').style.width = (idolData.waist / 60 * 100) + '%';
            document.getElementById('idolArmBar').style.width = (idolData.arm / 60 * 100) + '%';
            document.getElementById('idolBodyFatBar').style.width = idolData.bodyFat + '%';

            document.getElementById('userShoulder').textContent = userBodyData.shoulder + ' cm';
            document.getElementById('userChest').textContent = userBodyData.chest + ' cm';
            document.getElementById('userWaist').textContent = userBodyData.waist + ' cm';
            document.getElementById('userArm').textContent = userBodyData.arm + ' cm';
            document.getElementById('userBodyFat').textContent = userBodyData.bodyFat + '%';

            document.getElementById('userShoulderBar').style.width = (userBodyData.shoulder / 60 * 100) + '%';
            document.getElementById('userChestBar').style.width = (userBodyData.chest / 60 * 100) + '%';
            document.getElementById('userWaistBar').style.width = (userBodyData.waist / 60 * 100) + '%';
            document.getElementById('userArmBar').style.width = (userBodyData.arm / 60 * 100) + '%';
            document.getElementById('userBodyFatBar').style.width = userBodyData.bodyFat + '%';

            const shoulderGap = Math.max(0, idolData.shoulder - userBodyData.shoulder);
            const chestGap = Math.max(0, idolData.chest - userBodyData.chest);
            const waistGap = Math.max(0, userBodyData.waist - idolData.waist);
            const armGap = Math.max(0, idolData.arm - userBodyData.arm);

            document.getElementById('shoulderGap').textContent = shoulderGap + ' cm';
            document.getElementById('chestGap').textContent = chestGap + ' cm';
            document.getElementById('waistGap').textContent = waistGap + ' cm';
            document.getElementById('armGap').textContent = armGap + ' cm';

            const totalGap = (shoulderGap + chestGap + armGap + waistGap) / 4;
            const strengthNeeded = Math.min(100, Math.round(totalGap * 3));
            
            document.getElementById('strengthNeeded').textContent = '+' + strengthNeeded + '%';
            document.getElementById('strengthNeededBar').style.width = strengthNeeded + '%';
            
            let message = '';
            if (strengthNeeded > 50) {
                message = "🔥 Big goals! You'll need significant gains to reach idol physique.";
            } else if (strengthNeeded > 25) {
                message = "💪 Great progress! Keep pushing to reach your idol's measurements.";
            } else if (strengthNeeded > 0) {
                message = "✨ You're close! Just a bit more work to match your idol.";
            } else {
                message = "🎉 Congratulations! You've already achieved your idol's measurements!";
            }
            document.getElementById('strengthMessage').textContent = message;
        }

        // ========== FREQUENCY MULTIPLIER ==========
        function getFrequencyMultiplier() {
            const multipliers = { 1: 0.5, 2: 1.0, 3: 1.5, 4: 2.0, 5: 2.5, 6: 3.0 };
            return multipliers[workoutFrequency] || 1.0;
        }

        function calculateMonthlyVolume(month) {
            const routines = monthlyRoutines[month] || [];
            let totalVolume = 0;
            routines.forEach(routine => {
                routine.exercises.forEach(ex => totalVolume += (ex.sets * ex.reps));
            });
            return totalVolume;
        }

        function calculateMonthlyStrength() {
            const frequencyMultiplier = getFrequencyMultiplier();
            document.getElementById('frequencyMultiplierDisplay').textContent = `Multiplier: ${frequencyMultiplier}x`;
            
            const monthlyGains = {};
            let cumulativeGain = 0;

            for (let month = 1; month <= 12; month++) {
                const volume = calculateMonthlyVolume('month' + month);
                let gain = volume === 0 ? 0 : Math.round((volume / 100) * 10 * frequencyMultiplier);
                gain = Math.min(30, gain);
                cumulativeGain += gain;
                
                monthlyGains[month] = gain;
                const element = document.getElementById('month' + month + 'Strength');
                if (element) {
                    element.textContent = gain > 0 ? `+${gain}%` : '0%';
                }
            }

            return monthlyGains;
        }

        function renderChart() {
            const monthlyGains = calculateMonthlyStrength();
            const ctx = document.getElementById('strengthChart').getContext('2d');
            
            if (strengthChart) strengthChart.destroy();

            const labels = [];
            const data = [];
            for (let month = 1; month <= 12; month++) {
                labels.push(`M${month}`);
                data.push(monthlyGains[month] || 0);
            }

            // Generate gradient colors
            const pointColors = [];
            for (let month = 1; month <= 12; month++) {
                if (month <= 4) pointColors.push('#3b82f6');
                else if (month <= 8) pointColors.push('#8b5cf6');
                else pointColors.push('#ec4899');
            }

            strengthChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Monthly strength gain (%)',
                        data: data,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.3,
                        fill: true,
                        pointBackgroundColor: pointColors,
                        pointBorderColor: 'white',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: (context) => `+${context.raw}% strength`
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0,0,0,0.05)' },
                            title: { display: true, text: 'Strength gain %' }
                        }
                    }
                }
            });
        }

        function renderMonthlyRoutines() {
            const container = document.getElementById('monthlyRoutinesContainer');
            const monthKey = 'month' + currentRoutineMonth;
            const routines = monthlyRoutines[monthKey] || [];

            if (routines.length === 0) {
                container.innerHTML = '<div class="text-sm p-4 bg-yellow-50 rounded-lg border border-yellow-200"><i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>No routines for month ' + currentRoutineMonth + ' yet.</div>';
                return;
            }

            container.innerHTML = routines.map(routine => {
                const exercisesHtml = routine.exercises.map(ex => `
                    <div class="flex items-center justify-between text-sm bg-white p-2 rounded-lg border border-gray-100">
                        <span>${ex.name}</span>
                        <span>${ex.sets} × ${ex.reps}</span>
                    </div>
                `).join('');
                
                return `
                    <div class="bg-gray-50 rounded-xl p-4 border border-gray-200">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold">${routine.name}</h3>
                            <button class="text-red-400 hover:text-red-600 delete-monthly-routine" data-month="${currentRoutineMonth}" data-id="${routine.id}">
                                <i class="far fa-trash-alt"></i>
                            </button>
                        </div>
                        <div class="space-y-1.5">${exercisesHtml}</div>
                    </div>
                `;
            }).join('');

            document.querySelectorAll('.delete-monthly-routine').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const month = btn.dataset.month;
                    const id = btn.dataset.id;
                    const monthKey = 'month' + month;
                    
                    monthlyRoutines[monthKey] = monthlyRoutines[monthKey].filter(r => r.id !== id);
                    saveMonthlyRoutines();
                    renderMonthlyRoutines();
                    renderChart();
                });
            });
        }

        function showAddRoutineForm() {
            const container = document.getElementById('monthlyRoutinesContainer');
            
            const formDiv = document.createElement('div');
            formDiv.className = 'bg-blue-50 p-4 rounded-xl border-2 border-blue-200 mt-2 mb-4';
            formDiv.innerHTML = `
                <div class="mb-3">
                    <input type="text" id="newMonthlyRoutineName" placeholder="Routine name" class="w-full border p-2 rounded-lg text-sm">
                </div>
                <div id="newMonthlyExercisesList" class="space-y-2 mb-3"></div>
                <div class="flex gap-2">
                    <button id="addMonthlyExerciseRowBtn" class="bg-gray-200 text-sm px-3 py-1.5 rounded-full">add exercise</button>
                    <button id="saveMonthlyRoutineBtn" class="bg-blue-600 text-white text-sm px-4 py-1.5 rounded-full">save</button>
                    <button id="cancelMonthlyRoutineBtn" class="bg-white border text-sm px-4 py-1.5 rounded-full">cancel</button>
                </div>
            `;

            container.insertBefore(formDiv, container.firstChild);

            function addExerciseRow() {
                const list = document.getElementById('newMonthlyExercisesList');
                const row = document.createElement('div');
                row.className = 'flex gap-2 items-center bg-white p-2 rounded-lg';
                row.innerHTML = `
                    <input type="text" placeholder="Exercise" class="ex-name flex-1 text-sm border rounded p-1.5">
                    <input type="number" placeholder="Sets" class="ex-sets w-16 text-sm border rounded p-1.5">
                    <input type="number" placeholder="Reps" class="ex-reps w-16 text-sm border rounded p-1.5">
                    <button class="remove-ex-row text-red-400">✕</button>
                `;
                row.querySelector('.remove-ex-row').addEventListener('click', () => row.remove());
                list.appendChild(row);
            }

            addExerciseRow();

            document.getElementById('addMonthlyExerciseRowBtn').addEventListener('click', addExerciseRow);
            document.getElementById('cancelMonthlyRoutineBtn').addEventListener('click', () => formDiv.remove());

            document.getElementById('saveMonthlyRoutineBtn').addEventListener('click', () => {
                const name = document.getElementById('newMonthlyRoutineName').value.trim();
                if (!name) return alert('Name required');

                const exerciseRows = document.querySelectorAll('#newMonthlyExercisesList > div');
                const exercises = [];
                
                for (let row of exerciseRows) {
                    const exName = row.querySelector('.ex-name')?.value.trim();
                    const sets = row.querySelector('.ex-sets')?.value.trim();
                    const reps = row.querySelector('.ex-reps')?.value.trim();
                    
                    if (exName && sets && reps) {
                        exercises.push({ name: exName, sets: parseInt(sets), reps: parseInt(reps) });
                    }
                }

                if (exercises.length === 0) return alert('Add exercises');

                const newId = 'routine_' + Date.now();
                const monthKey = 'month' + currentRoutineMonth;
                
                if (!monthlyRoutines[monthKey]) monthlyRoutines[monthKey] = [];
                monthlyRoutines[monthKey].push({ id: newId, name, exercises });
                
                saveMonthlyRoutines();
                formDiv.remove();
                renderMonthlyRoutines();
                renderChart();
            });
        }

        // ========== PROFILE RENDERING ==========
        function renderProfile() {
            document.getElementById('profileName').textContent = profile.name;
            document.getElementById('profileGoal').innerHTML = `<i class="far fa-flag mr-1"></i> goal: ${profile.goal}`;
            
            const initials = profile.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
            
            if (profile.profilePic) {
                document.getElementById('profileImage').src = profile.profilePic;
                document.getElementById('profileImage').classList.remove('hidden');
                document.getElementById('profileInitials').classList.add('hidden');
            } else {
                document.getElementById('profileImage').classList.add('hidden');
                document.getElementById('profileInitials').classList.remove('hidden');
                document.getElementById('profileInitials').textContent = initials;
            }
        }

        // ========== EVENT LISTENERS ==========
        document.addEventListener('DOMContentLoaded', () => {
            renderProfile();
            renderPhotos();
            renderMonthlyRoutines();
            renderPrefixRoutines(); // NEW
            renderChart();
            calculateStrengthGrowth();

            // Load saved idol/user data
            if (idolData && userBodyData) {
                updateComparison();
            }

            // Photo month tabs
            document.querySelectorAll('.month-tab[data-month]').forEach(tab => {
                if (!tab.classList.contains('routine-tab')) {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.month-tab[data-month]').forEach(t => {
                            if (!t.classList.contains('routine-tab')) {
                                t.classList.remove('bg-blue-600', 'text-white');
                                t.classList.add('bg-gray-200', 'text-gray-700');
                            }
                        });
                        tab.classList.remove('bg-gray-200', 'text-gray-700');
                        tab.classList.add('bg-blue-600', 'text-white');
                        currentPhotoMonth = parseInt(tab.dataset.month);
                        renderPhotos();
                    });
                }
            });

            // Routine month tabs
            document.querySelectorAll('.routine-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.routine-tab').forEach(t => {
                        t.classList.remove('bg-blue-600', 'text-white');
                        t.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    tab.classList.remove('bg-gray-200', 'text-gray-700');
                    tab.classList.add('bg-blue-600', 'text-white');
                    currentRoutineMonth = parseInt(tab.dataset.month);
                    renderMonthlyRoutines();
                });
            });

            // NEW: Prefix routine buttons
            document.getElementById('addPrefixRoutineBtn').addEventListener('click', showAddPrefixRoutineForm);
            
            document.getElementById('usePrefixRoutineBtn').addEventListener('click', () => {
                if (prefixRoutines.length === 0) {
                    alert('No routines in your library. Create one first!');
                    return;
                }
                
                const modal = document.getElementById('selectRoutineModal');
                const list = document.getElementById('routineSelectionList');
                
                list.innerHTML = prefixRoutines.map(routine => `
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 hover:border-purple-500 cursor-pointer routine-select-item" data-id="${routine.id}">
                        <h4 class="font-semibold">${routine.name}</h4>
                        <div class="text-xs text-gray-500">${routine.exercises.length} exercises</div>
                    </div>
                `).join('');
                
                modal.classList.remove('hidden');
                
                document.querySelectorAll('.routine-select-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const routineId = item.dataset.id;
                        const routine = prefixRoutines.find(r => r.id === routineId);
                        if (routine) {
                            addPrefixRoutineToMonth(routine);
                            modal.classList.add('hidden');
                        }
                    });
                });
            });

            document.getElementById('closeRoutineModal').addEventListener('click', () => {
                document.getElementById('selectRoutineModal').classList.add('hidden');
            });

            // Quick add example routines
            document.querySelectorAll('.quick-add-routine').forEach(btn => {
                btn.addEventListener('click', () => {
                    const mode = btn.dataset.mode;
                    let newRoutine;
                    
                    if (mode === 'easy') {
                        newRoutine = {
                            id: 'prefix_easy_' + Date.now(),
                            name: 'Easy Mode',
                            exercises: [
                                { name: 'Push-ups', sets: 10, reps: 5 },
                                { name: 'Squats', sets: 10, reps: 5 }
                            ]
                        };
                    } else if (mode === 'medium') {
                        newRoutine = {
                            id: 'prefix_medium_' + Date.now(),
                            name: 'Medium Mode',
                            exercises: [
                                { name: 'Push-ups', sets: 15, reps: 4 },
                                { name: 'Squats', sets: 20, reps: 4 },
                                { name: 'Lunges', sets: 10, reps: 4 }
                            ]
                        };
                    } else {
                        newRoutine = {
                            id: 'prefix_hard_' + Date.now(),
                            name: 'Hard Mode',
                            exercises: [
                                { name: 'Push-ups', sets: 20, reps: 5 },
                                { name: 'Pull-ups', sets: 8, reps: 4 },
                                { name: 'Dips', sets: 12, reps: 4 },
                                { name: 'Burpees', sets: 10, reps: 3 }
                            ]
                        };
                    }
                    
                    prefixRoutines.push(newRoutine);
                    savePrefixRoutines();
                    renderPrefixRoutines();
                });
            });

            document.getElementById('addMonthlyRoutineBtn').addEventListener('click', showAddRoutineForm);

            // Frequency buttons
            document.querySelectorAll('.frequency-badge').forEach(btn => {
                btn.addEventListener('click', () => {
                    const freq = parseInt(btn.dataset.frequency);
                    workoutFrequency = freq;
                    saveFrequency();
                    
                    document.querySelectorAll('.frequency-badge').forEach(b => {
                        b.classList.remove('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                        b.classList.add('border-gray-300');
                    });
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                    
                    renderChart();
                });

                if (parseInt(btn.dataset.frequency) === workoutFrequency) {
                    btn.classList.add('selected', 'bg-blue-600', 'text-white', 'border-blue-600');
                }
            });

            // Photo upload
            document.getElementById('photoInput').addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = async (event) => {
                    let monthKey = 'month' + currentPhotoMonth;
                    if (!photos[monthKey]) photos[monthKey] = [];
                    if (!photoMeasurements[monthKey]) photoMeasurements[monthKey] = [];
                    
                    const measurements = await estimateBodyMeasurements(event.target.result);
                    
                    photos[monthKey].push({ 
                        dataURL: event.target.result, 
                        timestamp: Date.now() 
                    });
                    
                    photoMeasurements[monthKey].push(measurements);
                    
                    savePhotos();
                    savePhotoMeasurements();
                    renderPhotos();
                };
                reader.readAsDataURL(file);
            });

            // Idol photo upload
            document.getElementById('uploadIdolBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = async (event) => {
                        document.getElementById('idolImage').src = event.target.result;
                        document.getElementById('idolImage').classList.remove('hidden');
                        document.getElementById('idolPlaceholder').classList.add('hidden');
                        document.getElementById('idolImageContainer').classList.add('idol-glow');

                        const measurements = await estimateBodyMeasurements(event.target.result);
                        saveIdolData(measurements);
                        
                        if (userBodyData) updateComparison();
                    };
                    reader.readAsDataURL(file);
                };
                input.click();
            });

            // User body photo upload
            document.getElementById('uploadUserBodyBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = async (e) => {
                    const file = e.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = async (event) => {
                        document.getElementById('userImage').src = event.target.result;
                        document.getElementById('userImage').classList.remove('hidden');
                        document.getElementById('userPlaceholder').classList.add('hidden');
                        document.getElementById('userImageContainer').classList.add('user-glow');

                        const measurements = await estimateBodyMeasurements(event.target.result);
                        saveUserBodyData(measurements);
                        
                        if (idolData) updateComparison();
                    };
                    reader.readAsDataURL(file);
                };
                input.click();
            });

            // Profile edit
            document.getElementById('editProfileBtn').addEventListener('click', () => {
                document.getElementById('profileView').classList.add('hidden');
                document.getElementById('profileEdit').classList.remove('hidden');
            });

            document.getElementById('cancelProfileEditBtn').addEventListener('click', () => {
                document.getElementById('profileView').classList.remove('hidden');
                document.getElementById('profileEdit').classList.add('hidden');
                document.getElementById('editName').value = profile.name;
                document.getElementById('editGoal').value = profile.goal;
            });

            document.getElementById('saveProfileBtn').addEventListener('click', () => {
                const newName = document.getElementById('editName').value.trim();
                if (newName) {
                    profile.name = newName;
                    profile.goal = document.getElementById('editGoal').value.trim() || 'not set';
                    saveProfile();
                    renderProfile();
                }
                document.getElementById('profileView').classList.remove('hidden');
                document.getElementById('profileEdit').classList.add('hidden');
            });

            document.getElementById('profilePicUploadArea').addEventListener('click', () => {
                document.getElementById('profilePicInput').click();
            });

            document.getElementById('profilePicInput').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (event) => {
                    profile.profilePic = event.target.result;
                    saveProfile();
                    renderProfile();
                    
                    document.getElementById('editProfileImage').src = event.target.result;
                    document.getElementById('editProfileImage').classList.remove('hidden');
                    document.getElementById('editProfileInitials').classList.add('hidden');
                };
                reader.readAsDataURL(file);
            });
        });
    })();
</script>
</body>
</html>
